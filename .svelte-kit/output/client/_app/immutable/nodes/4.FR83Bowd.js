import"../chunks/DsnmJJEf.js";import{o as P}from"../chunks/D9RL6rbe.js";import{ai as V,af as A,h as D,aj as F,o as G,A as k,ak as I,p as J,t as R,k as u,a as $,b as L,a1 as f,s as d,c as C,al as b,d as m,r as h}from"../chunks/bNQyYDU7.js";import{d as N,s as g}from"../chunks/BZ3xhaWD.js";import{i as O}from"../chunks/a6MJfn4m.js";import{r as Q}from"../chunks/DrK46S25.js";function U(e,a,r=a){var s=new WeakSet;V(e,"input",async o=>{var t=o?e.defaultValue:e.value;if(t=E(e)?S(t):t,r(t),k!==null&&s.add(k),await A(),t!==(t=a())){var l=e.selectionStart,c=e.selectionEnd,i=e.value.length;if(e.value=t??"",c!==null){var v=e.value.length;l===c&&c===i&&v>i?(e.selectionStart=v,e.selectionEnd=v):(e.selectionStart=l,e.selectionEnd=Math.min(c,v))}}}),(G&&e.defaultValue!==e.value||D(a)==null&&e.value)&&(r(E(e)?S(e.value):e.value),k!==null&&s.add(k)),F(()=>{var o=a();if(e===document.activeElement){var t=I??k;if(s.has(t))return}E(e)&&o===S(e.value)||e.type==="date"&&!o&&!e.value||o!==e.value&&(e.value=o??"")})}function E(e){var a=e.type;return a==="number"||a==="range"}function S(e){return e===""?null:+e}class W extends Error{status;data;constructor(a,r,s){super(r),this.name="RpcError",this.status=a,this.data=s}}async function z(e,a,r,s){let o=`${e}/${r}`;const t={method:a,headers:{}};s!==void 0&&(o+=`?input=${encodeURIComponent(JSON.stringify(s))}`);const l=await fetch(o,t);if(!l.ok){let i;try{i=await l.json()}catch{i=await l.text().catch(()=>null)}throw new W(l.status,`RPC error on "${r}": ${l.status} ${l.statusText}`,i)}const c=await l.json();return c?.result?.data??c}function B(e){return{query(a,...r){return z(e,"GET",a,r[0])}}}const j=B("/api");var X=C('<div class="result svelte-1vknoic"> </div>'),Y=C('<div class="container svelte-1vknoic"><h1>RPC + SvelteKit + Rust</h1> <p>Server time: <strong> </strong></p> <div class="card svelte-1vknoic"><h2>Type-safe Query</h2> <input type="text" placeholder="Enter your name" class="svelte-1vknoic"/> <button class="svelte-1vknoic"> </button> <!></div></div>');function oe(e,a){J(a,!0);let r=b("SvelteKit"),s=b(""),o=b("loading..."),t=b(!1);async function l(){try{const n=await j.query("time"),y=new Date(n.timestamp*1e3);f(o,y.toLocaleString(),!0)}catch(n){f(o,"Error: "+n)}}async function c(){f(t,!0);try{f(s,await j.query("hello",u(r)),!0)}catch(n){f(s,"Error: "+n)}finally{f(t,!1)}}P(()=>{l()});var i=Y(),v=d(m(i),2),x=d(m(v)),T=m(x,!0);h(x),h(v);var w=d(v,2),p=d(m(w),2);Q(p);var _=d(p,2);_.__click=c;var q=m(_,!0);h(_);var H=d(_,2);{var K=n=>{var y=X(),M=m(y,!0);h(y),R(()=>g(M,u(s))),$(n,y)};O(H,n=>{u(s)&&n(K)})}h(w),h(i),R(()=>{g(T,u(o)),_.disabled=u(t),g(q,u(t)?"Sending...":"Say Hello")}),U(p,()=>u(r),n=>f(r,n)),$(e,i),L()}N(["click"]);export{oe as component};
